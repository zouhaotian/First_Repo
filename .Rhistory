cond.mult <- t(solve(x.star.cov[!cur.na, !cur.na],
t(as.matrix(x.star.cov[!cur.na, cur.na]))))
x=matrix(c(1,2,3,4,5,6,7,8,9,10),bycol=TRUE,ncol=2)
x=matrix(c(1,2,3,4,5,6,7,8,9,10),byrow=FALSE,ncol=2)
x
em.impute(x)
x=matrix(c(1,2,3,4,6,7),byrow=FALSE,ncol=2)
em.impute(x)
x=matrix(c(-1,0.5,3,0.4,0.6,7),byrow=FALSE,ncol=2)
x
em.impute(x)
em.impute(qst.x[,1])
1
1
em.impute(qst.x[,1:2])
em.impute(qst.x[,3:4])
em.impute(qst.x[,1:3])
em.impute(qst.x[,7:10])
q
q
q.x
View(q.x)
x=qst.x[,7:39]
x.star=x
x.bar1=colMeans(x,na.rm=TRUE)
x.bar1
for (i in 1:ncol(x)) {
if (sum(is.na(x.star[,i])>0)) {
x.star[is.na(x.star[,i]),i] <- x.bar1[i]
}
}
View(x.star)
step.diff <- Inf
x.star.bar <- colMeans(x.star)
x.star.cov <- cov(x.star)
View(x.star.cov)
x.star.next <- matrix(nrow=nrow(x), ncol=ncol(x))
View(x.star.next)
i=1
cur.na <- is.na(x[i,])
cur.row <- x.star[i,]
View(cur.na)
x.star.next[i,] <- as.matrix(cur.row)
View(x.star.next)
cur.row
for(i in 1:nrow(x)) {
cur.na <- is.na(x[i,])
cur.row <- x.star[i,]
if ((sum(cur.na)>0) && (sum(cur.na)<ncol(x))) {
if (sum(!cur.na)>1) {
cond.mult <- t(solve(x.star.cov[!cur.na, !cur.na],
x.star.cov[!cur.na, cur.na]))
}
else {
cond.mult <- t(solve(x.star.cov[!cur.na, !cur.na],
t(as.matrix(x.star.cov[!cur.na, cur.na]))))
}
cur.row[cur.na] <- x.star.bar[cur.na] + cond.mult %*%
t(as.matrix(x[i,!cur.na] -
x.star.bar[!cur.na]))
}
x.star.next[i,] <- as.matrix(cur.row)
}
x.star
View(x.star)
View(x.star.next)
step.diff <- max(abs(x.star-x.star.next))
x.star <- x.star.next
?is.null
if (!is.null(digits)) {
x.star[is.na(x)] <- round(x.star[is.na(x)], digits)
}
return(x.star)
x.star
c(12:14)
q.x = qst.x[,c(7:39)]
em.impute(q.x)
q.x=scale(q.x)
model.matrix(~., data=qst.x2)
?model.matrix
qst.x3 <- qst.x3[,-1]
View(qst.x3)
a=matrix(c(1,2,3,4,5,6),nrow=3)
a
b=a[,-1]
b
b=a[,1]
b
b=a[,-2]
b
b=a[,0]
b
b=a[,-1]
View(qst.x3)
View(qst.x2)
q.x = qst.x[,c(7:39)]
q.x.names=names(q.x)
q.x <- em.impute(q.x)
q.x <- scale(q.x)
colnames(q.x) <- q.x.names
qscale=qst.x
View(qscale)
qscale[,6] <- scale(qscale[,6]) # age
qscale[,3] <- factor(qscale[,3]) # siteID
qscale[,5] <- factor(qscale[,5]) # gender
qscale[qscale[,4]>6,4] <- 6 # racedetail
qscale[,4] <- factor(qscale[,4]) # racedetail
qst.x2 <- cbind(qscale[,3:6], q.x)
View(qst.x2)
qst.x3 <- model.matrix(~., data=qst.x2)
View(qst.x3)
x.names <- colnames(qst.x3)
qst.x3 <- qst.x3[,-1]
View(qst.x3)
out <- matrix(nrow=length(x.names), ncol=15)
View(out)
for (i in 1:5) {
print(i)
cur.boot <- boot(cbind(q.x[,i+5], qst.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,3*i-2] <- exp(cur.boot$t0)
out[,3*i-1] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3*i] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
}
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/QST_Ridge.csv")
?lognet
boot(cbind(q.x[,1+5], qst.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
q.x
View(q.x)
View(qst.x3)
View(q.x)
View(qst.x)
cur.boot <- boot(cbind(qst.x[,2], qst.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
View(qst.x3)
out[,3*i-2] <- exp(cur.boot$t0)
out[,3*i-1] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3*i] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/QST_Ridge.csv")
1-pchisq(2,24.83)
pchisq(2,24.83)
?pchisq
pchisq(24.83,2)
1-pchisq(24.83,2)
1-pchisq(7.047,1)
View(out)
View(qst.x)
qst.x3
View(qst.x3)
qst.x3[,-1]
a=matrix(c(1,2,3,5,6,7),byrow=TRUE)
a[,-1]
a=matrix(c(1,2,3,5,6,7),nrow=2,byrow=TRUE)
a
a[,-1]
plot(out)
boxplot(out)
View(out)
boxplot(data=out)
View(qscale)
View(qst.x2)
View(qscale)
View(qst.x3)
View(oppera.x)
auto.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_autonomic.csv");
psych.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_psych.csv");
qst.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_qst.csv");
psych.x[,8] <- psych.x[,8]-54
psych.x[psych.x[,19]<0,19] <- 0
psych.x[psych.x[,20]<0,20] <- 0
psych.x[psych.x[,21]<0,21] <- 0
psych.x[psych.x[,22]<0,22] <- 0
psych.x[psych.x[,23]<0,23] <- 0
psych.x[psych.x[,24]<0,24] <- 0
psych.x[psych.x[,25]<0,25] <- 0
psych.x[psych.x[,26]<0,26] <- 0
psych.x[psych.x[,27]<0,27] <- 0
psych.x[psych.x[,28]<0,28] <- 0
psych.x[psych.x[,37]<0,37] <- 0
qst.x[qst.x[,16]<0,16] <- 0
qst.x[qst.x[,22]>100,22] <- 100
qst.x[qst.x[,23]>100,23] <- 100
qst.x[qst.x[,24]>100,24] <- 100
qst.x[qst.x[,28]<0,28] <- 0
qst.x[qst.x[,29]<0,29] <- 0
qst.x[qst.x[,30]<0,30] <- 0
qst.x[qst.x[,31]<0,31] <- 0
qst.x[qst.x[,32]<0,32] <- 0
qst.x[qst.x[,33]<0,33] <- 0
qst.x[qst.x[,30]>100,30] <- 100
qst.x[qst.x[,34]>900,34] <- 900
qst.x[qst.x[,35]>900,35] <- 900
qst.x[qst.x[,36]>900,36] <- 900
oppera.x.all <- merge(qst.x, psych.x)
oppera.x.all <- merge(oppera.x.all, auto.x)
View(oppera.x.all)
auto.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_autonomic.csv");
psych.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_psych.csv");
qst.x=read.csv("/Users/haotianzou/Documents/bios992/data/final_qst.csv");
psych.x[,8] <- psych.x[,8]-54
psych.x[psych.x[,19]<0,19] <- 0
psych.x[psych.x[,20]<0,20] <- 0
psych.x[psych.x[,21]<0,21] <- 0
psych.x[psych.x[,22]<0,22] <- 0
psych.x[psych.x[,23]<0,23] <- 0
psych.x[psych.x[,24]<0,24] <- 0
psych.x[psych.x[,25]<0,25] <- 0
psych.x[psych.x[,26]<0,26] <- 0
psych.x[psych.x[,27]<0,27] <- 0
psych.x[psych.x[,28]<0,28] <- 0
psych.x[psych.x[,37]<0,37] <- 0
qst.x[qst.x[,16]<0,16] <- 0
qst.x[qst.x[,22]>100,22] <- 100
qst.x[qst.x[,23]>100,23] <- 100
qst.x[qst.x[,24]>100,24] <- 100
qst.x[qst.x[,28]<0,28] <- 0
qst.x[qst.x[,29]<0,29] <- 0
qst.x[qst.x[,30]<0,30] <- 0
qst.x[qst.x[,31]<0,31] <- 0
qst.x[qst.x[,32]<0,32] <- 0
qst.x[qst.x[,33]<0,33] <- 0
qst.x[qst.x[,30]>100,30] <- 100
qst.x[qst.x[,34]>900,34] <- 900
qst.x[qst.x[,35]>900,35] <- 900
qst.x[qst.x[,36]>900,36] <- 900
oppera.x.all <- merge(qst.x, psych.x)
oppera.x.all <- merge(oppera.x.all, auto.x)
oppera.x <- oppera.x.all[,-(1:6)]
View(qst.x)
View(psych.x)
View(auto.x)
View(oppera.x)
View(oppera.x.all)
View(oppera.x)
View(oppera.x.all)
source("/Users/haotianzou/Documents/bios992/code_HTZ/em_impute2.R")
oppera.x_cat = oppera.x.all[,1:4]
View(oppera.x_cat)
View(oppera.x.all)
View(oppera.x.all)
summary(oppera.x_cat)
source("/Users/haotianzou/Documents/bios992/code_HTZ/em_impute2.R")
# categorical variables analysis
oppera.x_cat = oppera.x.all[,2:5] # baselinecase siteID racedetails gender
summary(oppera.x_cat)
oppera.x_cat[oppera.x_cat[,3]>6,3] = 6
View(oppera.x_cat)
cat_out = table(oppera.x_cat$baselinecase,oppera.x_cat$SiteID)
cat_out_siteID = table(oppera.x_cat$baselinecase,oppera.x_cat$SiteID)
cat_out_siteID
prop.table(cat_out_siteID)
a=scale(qst.x[,6])
View(a)
mu_0=c(153,131)
install.packages("sas7bdat")
library(sas7bdat)
?read.sas7bdat
install.packages(c("assertthat", "cluster", "codetools", "digest", "foreign", "geosphere", "HSAUR2", "lattice", "lazyeval", "mapproj", "maps", "MASS", "Matrix", "mgcv", "mvtnorm", "nlme", "Rcpp", "reshape2", "rpart", "scales", "sp", "stringi", "stringr", "survival", "tibble", "XML"))
install.packages(c("digest", "MASS", "mgcv", "mvtnorm", "nlme", "Rcpp", "rpart", "sp", "XML"))
?write.csv
?boot
library(boot)
?boot
?apply
?quantile
?apply
?quantile
?t0
citation(boot)
citation(package=boot)
library(boot)
library(glmnet)
library(parallel)
citation(boot)
citation(package=boot)
?citation
citation(package="boot")
RStudio.Version()
?boot
library(boot)
packageVersion("boot")
packageVersion("glmnet")
packageVersion("parallel")
?scale
c=c(1,2,3,4)
scale(c)
c=c(1,2,3,4)scale(c)
c=c(1,2,3)
scale(c)
scale(auto.x$respid)
scale(c(1,2,3))
library(boot)
library(glmnet)
library(parallel)
library(sas7bdat)
source("/Users/haotianzou/Documents/bios992/code_HTZ/em_impute2.R")
source("/Users/haotianzou/Documents/bios992/code_HTZ/boot_ridge.R")
?sas7bdat.sources
?sas7bdat
??sas7bdat
auto.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/auto_r.sas7bdat")
View(auto.x_sas)
View(auto.x_sas)
a.x = auto.x_sas[,c(3,48:54,4:47)]
View(a.x)
a.x.names=names(a.x)
a.x2 = cbind(auto.x_sas[,2],a.x)
View(a.x)
View(a.x2)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(qst.x3)
x.names <- colnames(a.x3)
x.names
out <- matrix(nrow=length(x.names), ncol=6)
View(out)
cur.boot <- boot(cbind(auto.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
View(cur.boot)
cur.boot[["t0"]]
out[,3*i-2] <- exp(cur.boot$t0)
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
out
View(out)
cur.boot
View(a.x3)
cur.boot$t0
out[,1] <- exp(cur.boot$t0[,c(1,3:54)])
out[,1] <- exp(cur.boot$t0[,c(1,3:55)])
cur.boot$t0[,c(1,3:54)]
cur.boot$t0[,1]
View(a.x3)
a.x3 <- a.x3[,-1]
cur.boot <- boot(cbind(auto.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
cur.boot
View(cur.boot)
cur.boot[["t0"]]
rownames(out) <- x.names
write.csv(out, "AUTO_Ridge.csv")
write.csv(out, "Users/haotianzou/Documents/bios992/output/AUTO_Ridge.csv")
write.csv(out, "Users/haotianzou/Documents/bios992/output/AUTO_Ridge.csv")
write.csv(out, "/Users/haotianzou/Documents/bios992/output/AUTO_Ridge.csv")
psych.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/psych_r.sas7bdat")
View(psych.x_sas)
auto.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/auto_r.sas7bdat")
a.x = auto.x_sas[,c(3,48:54,4:47)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(auto.x_sas)
cur.boot <- boot(cbind(auto.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/AUTO_Ridge.csv")
psych.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/psych_r.sas7bdat")
View(psych.x_sas)
a.x = psych.x_sas[,c(3,43:49,4:42)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(a.x3)
cur.boot <- boot(cbind(psych.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/PSYCH_Ridge.csv")
qst.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/qst_r.sas7bdat")
View(qst.x_sas)
a.x = psych.x_sas[,c(3,37:43,4:36)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(a.x3)
a.x = qst.x_sas[,c(3,37:43,4:36)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(a.x3)
cur.boot <- boot(cbind(qst.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/QST_Ridge.csv")
?pchisq
1-pchisq(6.708,7)
library(boot)
library(glmnet)
library(parallel)
library(sas7bdat)
source("/Users/haotianzou/Documents/bios992/code_HTZ/em_impute2.R")
source("/Users/haotianzou/Documents/bios992/code_HTZ/boot_ridge.R")
auto.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/auto_r.sas7bdat")
View(auto.x_sas)
a.x = auto.x_sas[,c(3,48:55,4:47)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
cur.boot <- boot(cbind(auto.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/AUTO_Ridge.csv")
library(boot)
library(glmnet)
library(parallel)
library(sas7bdat)
source("/Users/haotianzou/Documents/bios992/code_HTZ/em_impute2.R")
source("/Users/haotianzou/Documents/bios992/code_HTZ/boot_ridge.R")
psych.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/psych_r.sas7bdat")
View(psych.x_sas)
a.x = psych.x_sas[,c(3,43:50,4:42)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(a.x3)
cur.boot <- boot(cbind(psych.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/PSYCH_Ridge.csv")
qst.x_sas = read.sas7bdat("/Users/haotianzou/Documents/bios992/data/qst_r.sas7bdat")
View(qst.x_sas)
a.x = qst.x_sas[,c(3,37:44,4:36)]
a.x.names=names(a.x)
a.x3 <- model.matrix(~., data=a.x)
x.names <- colnames(a.x3)
a.x3 <- a.x3[,-1]
out <- matrix(nrow=length(x.names), ncol=3)
View(a.x3)
cur.boot <- boot(cbind(qst.x_sas[,2], a.x3), boot.ridge, R=1000,
parallel="multicore", ncpus=detectCores())
out[,1] <- exp(cur.boot$t0)
out[,2] <- exp(apply(cur.boot$t, 2, quantile, probs=0.025))
out[,3] <- exp(apply(cur.boot$t, 2, quantile, probs=0.975))
rownames(out) <- x.names
write.csv(out, "/Users/haotianzou/Documents/bios992/output/QST_Ridge.csv")
library(boot)
library(glmnet)
library(parallel)
library(sas7bdat)
citation()
citation("boot")
pnorm(0.14)
?pnorm
qnorm(0.56)
qnorm(0.1)
qnorm(0)
qnorm(0.01)
qnorm(0.025)
qnorm(0.975)
x=matrix(c(3,2,2,2,3,-2),nrow=2,byrow=TRUE)
x
t(x)%*%x
ev=eigen(t(x)%*%x)
ev
1/sqrt(18)
?ginv
library(MASS)
a=matrix(c(3,2,2,2,3,-2),nrow=2,byrow=TRUE)
a
ginv(a)
View(a)
library("boot")
library("parallel")
library("glmnet")
?glmnet
??lasso
??survival
install.packages("tidyverse")
library(tidyverse)
library("tidyverse")
tidyverse_update()
library(tidyverse)
setwd("~/Desktop/First_Repo")
args = commandArgs(trailingOnly=TRUE)
print('Hello, world!')
a = sqrt(as.numeric(args[1]))
print(a)
